---
title: "slr_mlr_1"
author: "Alberto Tomasin"
output: 
  html_document: 
    toc: yes
---
# Esercizio 1

I dati in `grains.dat` sono stati raccolti nel 2007 in uno studio sula relazione tra la resa in termini di alcool nel processo di distillazione e l'azoto contenuto nel grano distillato. I dati sono stati raccolti in quattro diverse aree del Regno Unito. Il dataset ha tre colonne: **nitrogen** è la percentuale di azoto (per kilogrammo), **alcohol** è la resa in alcool in Litri per Tonnellata, **elocation** indica il luogo in cui è stato coltivato il grano.

```{r}
grain_df <- read.csv('data/grains.dat', sep = ' ', header = TRUE)
head(grain_df)
```



1. Si produca un grafico dei dati. La relazione tra le variabili in esame appare lineare?

```{r}
plot(grain_df$alcohol ~ grain_df$nitrogen)
```

La relazione appare lineare, con una tendenza a decrescere, in particolare possiamo affermare che all'aumentare della concentrazione di azoto, il grado alcolico diminuisce.


2. Si dia una stima puntuale per $\alpha$ e $\beta$.

Per calcolare la stima puntuale di $\alpha$ e $\beta$ posso usare le formule:
$$
\beta = \frac{\sum_{i=1}^n (x_i - \bar x)(y_i - \bar y)}{\sum_{i=1}^n (x_i - \bar x)^2}
$$

$$
\alpha = \bar y -\beta \bar x
$$

basate sul principio dei minimi quadrati, che tenta di minimizzare la somma dei quadrati degli errori.

Possiamo calcolare la stessa stima usando R

```{r}
fit1 <- lm(alcohol ~ nitrogen, data = grain_df)
coef(fit1)
```

3. Si dia una stima intervallare ad un livello di confidenza di 99% per $\alpha$ e $\beta$.

```{r}
confint(fit1, level = .99)
```

4. Quali sono le assunzioni necessarie per poter aver stime puntuali per i valori $\alpha$ e $\beta$? Quali sono le assunzioni necessarie per poter ottenere delle stime intervallari per $\alpha$ e $\beta$?

Le assunzioni necessarie per poter avere stime puntuali e stime intervallari per $\alpha$ e $\beta$ sono le assunzioni relative ai modelli lineari: linearità, indipendenza dagli errori, normalità degli errori, omoschedasticità.

**linearità**
```{r}
plot(predict(fit1), residuals(fit1))
abline(h = 0, col = 'red')
```

L'assunzione di linearità è verificata nel momento in cui i punti si distribuiscono casualmente attorno allo zero.

**indipendenza degli errori**

tramite un grafico dei residui siamo in grado di verificare l'indipendenza degli errori
```{r}
plot(residuals(fit1))
```

Notiamo che non viene seguito alcun pattern, l'assunzione di indipendenza risulta verificata

**normalità dei residui**
```{r}
qqnorm(residuals(fit1))
qqline(residuals(fit1), col = 'blue')
```

I punti sono disposti attorno alla retta ad indicare una buona normalità dei residui. L'assunzione di normalità è verificata.

**omoschedasticità**

possiamo anche in questo caso usare il grafico valori predetti vs errori per verificare l'assuzione di omoschedasticità
```{r}
plot(predict(fit1), residuals(fit1))
```

